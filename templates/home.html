<!DOCTYPE html>
<html>
  <head>
    <title>StudentSpace</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='home-style.css') }}"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400&display=swap"
      rel="stylesheet"
    />

    <script>
      fetch('/grades')
          .then(response => response.json())
          .then(data => {
              const studentIDs = data.map(row => row[0]);
              const grades = data.map(row => [row[1], row[2], row[3], row[4], row[5], row[6], row[7], row[8]]);

              const ctx = document.getElementById('gradeChart').getContext('2d');
              new Chart(ctx, {
                  type: 'line',
                  data: {
                      labels: ['s1', 's2', 's3', 's4', 's5', 's6', 's7', 's8'],
                      datasets: studentIDs.map((id, index) => ({
                          label: `Student ${id}`,
                          data: grades[index],
                          fill: false,
                          borderColor: getRandomColor(),
                          tension: 0.4
                      }))
                  },
                  options: {
                      indexAxis: 'y', // Interchange x and y-axis
                      scales: {
                          x: {
                              beginAtZero: true,
                              max: 10
                          }
                      }
                  }
              });
          });

      // Function to generate random colors
      function getRandomColor() {
          const letters = '0123456789ABCDEF';
          let color = '#';
          for (let i = 0; i < 6; i++) {
              color += letters[Math.floor(Math.random() * 16)];
          }
          return color;
      }
  </script>


  </head>
  <body>
    <div class="StudentSpace">
      <div class="header">
        <div class="left-section">StudentSpace.</div>
        <div class="middle-section">
          <input class="search-bar" type="text" placeholder="Search" />
          <img class="search-icon" src="../assets/search.png" />
        </div>
        <div class="right-section">
          <div class="name">
            <a href="" class="name">Hii {{fullname}} </a>
          </div>
          <div class="notification-icon">
            <img class="rs-notification" src="../assets/notification.png" />
          </div>
          <div class="settings-icon">
            <img class="rs-settings" src="../assets/settings.png" />
          </div>
        </div>
      </div>
      <div class="sidebar">
        {% if username %}
        <div class="sidebar-tabs">
          <a href="{{ url_for('profile') }}">Profile</a>
        </div>

        {% if user_type == 'student' %}
        <div class="sidebar-tabs">
          <a href="{{ url_for('courses') }}">Courses</a>
        </div>
        <div class="sidebar-tabs">
          <a href="{{ url_for('grades') }}">Performance</a>
        </div>
        <div class="sidebar-tabs">
          <a href="{{ url_for('attendance') }}">Attendance</a>
        </div>
        <div class="sidebar-tabs">
          <a href="#">Notes</a>
        </div>
        {% elif user_type == 'faculty' %}
        <div class="sidebar-tabs">
          <a href="{{ url_for('courses') }}">Courses</a>
        </div>
        <div class="sidebar-tabs">
          <a href="{{ url_for('grades') }}">Class grades</a>
        </div>
        <div class="sidebar-tabs">
          <a href="{{ url_for('attendance') }}">Class Attendance</a>
        </div>
        <div class="sidebar-tabs">
          <a href="#">Notes</a>
        </div>
        {% elif user_type == 'admin' %}
        <div class="sidebar-tabs">
          <a href="{{ url_for('courses') }}">Courses</a>
        </div>
        <div class="sidebat-tabs">
          <a href="#">User management</a>
        </div>
        <div class="sidebat-tabs">
          <a href="#">Role management</a>
        </div>
        <div class="sidebat-tabs">
          <a href="#">Permission management</a>
        </div>
        {% endif %} {% endif %}
      </div>

      <div class="main-section">
        <div class="chart-canvas">
          <canvas id="myChart"></canvas>
        </div>
        <div class="main">
          <div class="main1">
            <div class="graph">
              <canvas id="gradeChart"></canvas>
            </div>
            <div class="attendance"></div>
          </div>
          <div class="main2">
            <div class="tasks"></div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
